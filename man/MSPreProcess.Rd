% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/10-PreProcess.R
\name{MSPreProcess}
\alias{MSPreProcess}
\title{Preprocess Mutational Signature Data}
\usage{
MSPreProcess(
  ms_signature,
  filter_tumor_type = "all",
  col_thresh = 0.05,
  accuracy_thresh = 0,
  ms_search_pattern = "SBS|DBS|CN|CNV|SV|ID|INDEL"
)
}
\arguments{
\item{ms_signature}{A data frame containing raw mutational signature data.
Must include:
\itemize{
\item A column matching tumor type (auto-detected)
\item A column with signature accuracy scores (auto-detected)
\item Numeric columns for signatures (filtered by \code{col_thresh} and \code{ms_search_pattern})
}}

\item{filter_tumor_type}{Character. Specify tumor type(s) to retain.
Special values:
\itemize{
\item \code{"all"} (default): Keeps all tumor types
\item \code{"luad"}: Keeps tumor types containing the characters "luad" (case-insensitive)
}}

\item{col_thresh}{Numeric \link{0-1}. Minimum proportion of non-zero values required to
retain a signature column (default: 0.05). Columns with >95\% zeros will be dropped.}

\item{accuracy_thresh}{Numeric \link{0-1}. Minimum accuracy score to retain samples
(default: 0, keeping all samples regardless of accuracy).}

\item{ms_search_pattern}{Regex pattern to identify mutational signature columns
(default: "SBS|DBS|CN|CNV|SV|ID|INDEL", case-insensitive).}
}
\value{
A filtered data frame with:
\itemize{
\item Rows: Samples passing tumor type and accuracy filters
\item Columns: Annotations + signature columns passing \code{col_thresh} and pattern match
Returns \code{NULL} with warning if no signature columns remain.
}
}
\description{
Filters and cleans mutational signature data based on tumor type, column validity thresholds,
and signature accuracy. Designed for genomic datasets with columns representing
mutational signatures (e.g., SBS, DBS, CNV).
}
\section{Processing Steps}{

\enumerate{
\item \strong{Column Filtering}:
\itemize{
\item Keeps annotation columns (character/non-numeric)
\item Drops numeric columns with >(1-\code{col_thresh}) zeros
}
\item \strong{Row Filtering}:
\itemize{
\item Subsets by \code{filter_tumor_type}
\item Drops samples with accuracy < \code{accuracy_thresh}
}
\item \strong{Validation}:
\itemize{
\item Checks if any signature columns remain
\item Warns if all filtered out
}
}
}


% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/10-PreProcess.R
\name{MatchSample}
\alias{MatchSample}
\title{Match Samples Across TCGA Datasets}
\usage{
MatchSample(ms_signature, bulk_data, col_id, ms_status_thresh = 0)
}
\arguments{
\item{ms_signature}{A data frame containing mutational signature data. Must include:
\itemize{
\item A sample ID column (auto-detected via case-insensitive "sample" pattern)
\item A numeric column specified by \code{col_id} for binarization.
}}

\item{bulk_data}{A matrix or data frame of expression counts with samples
as columns. Column names should contain TCGA sample IDs.}

\item{col_id}{Integer or string. Column index/name in \code{ms_signature} to use for:
\itemize{
\item Binarization (values > \code{ms_status_thresh} become 1, others 0)
\item Reporting in output as \code{ms_select}
}}

\item{ms_status_thresh}{Numeric. Threshold for converting the \code{col_id} column to
binary status (default: 0). Values above threshold become 1.}
}
\value{
A list with three components:
\describe{
\item{phenotype}{Named integer vector (names = sample IDs) of binarized values}
\item{matched_bulk_data}{Expression matrix subset to common samples}
\item{ms_select}{Character indicating which signature was used (column name)}
}
}
\description{
Identifies common samples between mutational signature data and TCGA expression
count matrix by sample ID truncation, then returns matched subsets with binary
phenotype encoding. Designed to resolve inconsistencies in TCGA sample identifiers
across different genomic datasets.
}
\section{Processing Details}{

\enumerate{
\item \strong{Sample ID Harmonization}:
\itemize{
\item Truncates IDs to the minimum length across both datasets (max 15 chars)
\item Case-sensitive exact matching after truncation
}
\item \strong{Phenotype Conversion}:
\itemize{
\item Converts \code{col_id} values to binary (0/1) based on threshold
}
\item \strong{Validation}:
\itemize{
\item Stops if no common samples found
\item Preserves sample order in output
}
}
}

\examples{
\dontrun{
# Mock data
sig_data <- data.frame(
  sample_id = c("TCGA-AB-1234-01", "TCGA-CD-5678-01"),
  APOBEC_score = c(0.8, 0.2)
)
exp_matrix <- matrix(rnorm(20), ncol = 4,
  dimnames = list(NULL, c("TCGA-AB-1234", "TCGA-EF-9012", "TCGA-CD-5678", "TCGA-GH-3456")))

# Basic usage
result <- MatchSample(
  ms_signature = sig_data,
  bulk_data = exp_matrix,
  col_id = "APOBEC_score", # or 1L
  ms_status_thresh = 0.5
)

# Output components
str(result)
# $ phenotype       : Named int [1:2] 1 0
# $ matched_TCGA_exp: num [1:5, 1:2] 0.481 -0.788 0.741 -0.311 -0.668 ...
# $ ms_select       : chr "APOBEC_score"
}

}
